YUI.add("moodle-mod_bigbluebuttonbn-recordings",function(e,t){M.mod_bigbluebuttonbn=M.mod_bigbluebuttonbn||{},M.mod_bigbluebuttonbn.recordings={datasource:null,locale:"en",profilefeatures:{},datatable:{},init:function(t){this.datasource=new e.DataSource.Get({source:M.cfg.wwwroot+"/mod/bigbluebuttonbn/bbb_broker.php?"}),this.locale=t.locale,this.profilefeatures=t.profile_features,this.datatable.columns=t.columns,this.datatable.data=t.data,t.recordings_html===!1&&(this.profilefeatures.includes("all")||this.profilefeatures.includes("showrecordings"))&&this.datatable_init()},datatable_init:function(){var e={weekday:"long",year:"numeric",month:"long",day:"numeric"},t=this.datatable.columns,n=this.datatable.data;for(var r=0;r<n.length;r++){var i=new Date(n[r].date);n[r].date=i.toLocaleDateString(this.locale,e)}YUI({lang:this.locale}).use("datatable","datatable-sort","datatable-paginator","datatype-number",function(e){var r=(new e.DataTable({width:"1075px",columns:t,data:n,rowsPerPage:10,paginatorLocation:["header","footer"]})).render("#bigbluebuttonbn_yui_table");return r})},recording_action_inprocess:function(t){var n=e.one("#recording-btn-"+t.action+"-"+t.recordingid),r=M.util.get_string("view_recording_list_actionbar_unpublishing","bigbluebuttonbn");t.action=="publish"&&(r=M.util.get_string("view_recording_list_actionbar_publishing","bigbluebuttonbn")),t.action=="delete"&&(r=M.util.get_string("view_recording_list_actionbar_deleting","bigbluebuttonbn")),n.setAttribute("alt",r),n.setAttribute("title",r),n.setAttribute("data-src",n.getAttribute("src")),n.setAttribute("src",M.cfg.wwwroot+"/mod/bigbluebuttonbn/pix/processing16.gif");var i=e.one("#recording-link-"+t.action+"-"+t.recordingid);i.setAttribute("data-onlcick",i.getAttribute("onclick")),i.setAttribute("onclick","")},recording_action_completed:function(t){var n=e.one("#recording-btn-"+t.action+"-"+t.recordingid),r=n.getAttribute("data-src"),i=e.one("#recording-link-"+t.action+"-"+t.recordingid),s=i.getAttribute("data-onlcick"),o="publish",u="show",a=M.util.get_string("view_recording_list_actionbar_publish","bigbluebuttonbn");e.one("#playbacks-"+t.recordingid).hide(),e.one("#preview-"+t.recordingid).hide(),t.action==="publish"&&(o="unpublish",u="hide",a=M.util.get_string("view_recording_list_actionbar_unpublish","bigbluebuttonbn"),e.one("#playbacks-"+t.recordingid).show(),e.one("#preview-"+t.recordingid).show()),n.setAttribute("id","recording-btn-"+o+"-"+t.recordingid),i.setAttribute("id","recording-link-"+o+"-"+t.recordingid),n.setAttribute("src",r.substring(0,r.length-4)+u),n.setAttribute("alt",a),n.setAttribute("title",a),i.setAttribute("onclick",s.replace(t.action,o))},recording_action_failed:function(t){var n=new M.core.alert({title:M.util.get_string("error","moodle"),message:t.message});n.show();var r=e.one("#recording-btn-"+t.action+"-"+t.recordingid),i=e.one("#recording-link-"+t.action+"-"+t.recordingid),s=M.util.get_string("view_recording_list_actionbar_unpublish","bigbluebuttonbn");t.action==="publish"&&(s=M.util.get_string("view_recording_list_actionbar_publish","bigbluebuttonbn")),r.setAttribute("id","recording-btn-"+t.action+"-"+t.recordingid),i.setAttribute("id","recording-link-"+t.action+"-"+t.recordingid),r.setAttribute("src",r.getAttribute("data-src")),r.setAttribute("alt",s),r.setAttribute("title",s),i.setAttribute("onclick",i.getAttribute("data-onlcick"))},recording_delete_completed:function(t){e.one("#recording-td-"+t.recordingid).remove()},recording_edit:function(t){var n=e.one(t),r=n.ancestor("div");console.info("Editing "+r.getAttribute("data-target")+"...");var i=r.one("> span");i.hide(),n.hide();var s=e.Node.create('<input type="text" class="form-control"></input>');s.setAttribute("id",r.getAttribute("id")),s.setAttribute("value",i.getHTML()),s.setAttribute("onkeydown","M.mod_bigbluebuttonbn.recordings.recording_edit_keydown(this);"),r.append(s)},recording_edit_keydown:function(t){if(event.keyCode==13){var n=t.value,r=e.one(t),i=r.ancestor("div"),s=i.one("> span"),o=i.one("> a");return setTimeout(function(){M.mod_bigbluebuttonbn.broker.recording_action("update",i.getAttribute("data-recordingid"),i.getAttribute("data-meetingid")),s.setHTML(n),r.hide(),s.show(),o.show()},0)}}}},"@VERSION@",{requires:["base","node","datasource-get","datasource-jsonschema","datasource-polling","moodle-core-notification"]});
